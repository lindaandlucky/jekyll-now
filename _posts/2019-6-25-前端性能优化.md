# 页面性能优化

前端性能优化分为两大部分：浏览器部分，代码部分

浏览器部分分为 网络层面。    浏览器层面。    服务端层面

代码部分有：构建层面，编码层面，ssr服务器端渲染，规范

## 浏览器是多进程的

渲染进程决定了浏览器的加载速度，默认每个tab都是一个进程，互不影响，主要作用就是为页面渲染，脚本执行，事件处理

GUI线程解析html,css ,构建dom树，页面重绘或者由于某些操作造成回流，该线程就会执行，与js线程互斥

js引擎负责处理js脚本，脚本要放在body下面，否则导致页面渲染加载阻塞

事件触发线程管理着事件队列

定时触发器线程

异步http请求线程

**浏览器的渲染流程**

DOM树构建

CSSOM树构建（css加载不会阻塞dom树解析（异步加载时dom树照常构建），但是会阻塞render树的渲染（渲染时需等待css加载完毕，因为render树需要css信息））

RenderObject树构建

布局

绘制

# 重排和重绘

如何减少重排和重绘

1. js尽量减少访问dom节点和css属性

2. 减少不必要的dom层级

3. 不要通过父级来改变子元素样式，最好直接改变子元素的样式

4. 尽量通过class来设计元素样式，切记用style多次操作单个属性

5. 尽可能为产生动画的元素使用固定定位或者绝对定位，这样的话修改css不会reflow

6. img标签要奢姿宽高，以减少重绘重排

7. 把dom离线后修改，如将一个dom脱离文档流，比如display；none.再修改属性，这里只发生一次回流

8. 尽量用transform来做形变和位移，不会造成回流

9. 权衡速度的平滑，比如实现一个动画，以一个像素为单位这样最平滑，但是reflow就会过于频繁，cpu很快会被完全占用，如果以3个像素为单位移动就会好很多

10. 不要用tables布局的另一个原因就是tables中某一个元素一旦触发reflow就会导致tables里所有的其他元素reflow。在适合用table的场合，可以设置table-layout为auto或者fixed

11. 避免不必要的复杂的css选择器

    总结：重排：元素的尺寸变了，位置变了

    ​          重绘： 元素的颜色背景，边框，轮廓变了，但是元素的几何尺寸没有变

    重排比重绘的成本要高很多

# 优化原则



1。减少http请求

2 使用内容传送网络CDN

3 避免空src或者href空值

4 gzip的组件

5css放在头部，js放在底部，scripts 添加defer或者async属性

6减少dns的查找

7.压缩资源

8避免重定向或找不到资源

9ajax优化，使ajax可缓存

10cookie优化

  减少cookie大小，对一些静态资源不需要使用cookie的氮素设置域

11 利用缓存

12 缩短服务器响应时间

# 优化工具

Google Page Speed

jsPerf&Benchmark.js







